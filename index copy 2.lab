(import config from "./config.lab")

(let url "http://localhost:3000/")
(let LAB_packages "/Users/panfeng/Desktop/Document/LAB_packages/")


(function (packageUnzip filePath packageName version)
    (let savePath (+ LAB_packages  packageName ))
    (zipObj.unzip
        filePath
        savePath
        (lambda (x)
             (folderObj.rename (+ savePath "/" packageName)  (+ savePath "/" version))
             (folderObj.remove filePath)
        )
    )
)


(if (folderObj.exists LAB_packages)
    (console.log "存在")
    (folderObj.mkdir LAB_packages)
)

(config.dependence.foreach (lambda (key value index _this)
        (supporter.downFile
            (+ url key ".zip")
            (+ LAB_packages  key ".zip")
            (lambda (filePath)
                (packageUnzip filePath  key 1)
            )
        )
    )
)